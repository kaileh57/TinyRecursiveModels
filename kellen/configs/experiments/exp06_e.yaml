defaults:
- arch_config: trm_baseline
- _self_
use_tpu: true
num_workers: 8
data_paths:
- gs://sculptor-tpu-experiments/data/sudoku-extreme-1k-aug-1000
data_paths_test: []
evaluators: []
global_batch_size: 12288  # Reduced from 24576 to prevent OOM (1536 per device)
epochs: 50000
eval_interval: 5000
min_eval_interval: 0
checkpoint_every_eval: true
save_checkpoint_steps: 1000
lr: 0.00014142  # Adjusted for reduced batch size (scaled by sqrt(12288/24576))
lr_min_ratio: 1.0
lr_warmup_steps: 2000
beta1: 0.9
beta2: 0.95
weight_decay: 1.0
puzzle_emb_lr: 0.00014142  # Adjusted for reduced batch size
puzzle_emb_weight_decay: 1.0
ema: true
ema_rate: 0.999
freeze_weights: false
seed: 0
project_name: TRM-Exp06-BatchScaling
run_name: exp06_e_batch12288_lr1.41e-04_OOMfixed
checkpoint_path: gs://sculptor-tpu-experiments/checkpoints/exp06-batch-size/exp06_e
load_checkpoint: null
eval_save_outputs: []
